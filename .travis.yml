branches:
  except:
    - master
    - production
  only:
    - develop
language: php
php:
  - 5.5
sudo: required
dist: trusty
script: phpunit Test.php
after_success:
  - wget https://ec4a542dbf90c03b9f75-b342aba65414ad802720b41e8159cf45.ssl.cf5.rackcdn.com/1.1.1/Linux/amd64/rack
  - chmod +x rack
  - git checkout -b production
  - git push --force --quiet "https://${GH_TOKEN}@${GH_REF}" production > /dev/null 2>&1
  - ./rack servers instance rebuild --name taboo.dev.total-apps.com.new --image-id ${RACK_IMAGE_ID} --admin-pass ${RACK_PASS} --username ${RACK_USER} --api-key ${RACK_KEY} --region ${RACK_REGION}
